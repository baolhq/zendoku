!function(r){var n=r.sudoku={};n.DIGITS="123456789";var a="ABCDEFGHI",e=n.DIGITS,i=null,t=null,f=null,u=null,v={easy:62,medium:53,hard:44,"very-hard":35,insane:26,inhuman:17};n.BLANK_CHAR=".",n.BLANK_BOARD=".................................................................................",n.generate=function(r,a){("string"==typeof r||void 0===r)&&(r=v[r]||v.easy),r=n._force_range(r,82,17),a=a||!0;for(var e="",t=0;t<81;++t)e+=".";var f=n._get_candidates_map(e),u=n._shuffle(i);for(var o in u){var s=u[o],l=n._rand_range(f[s].length),g=f[s][l];if(!n._assign(f,s,g))break;var h=[];for(var o in i){var s=i[o];1==f[s].length&&h.push(f[s])}if(h.length>=r&&n._strip_dups(h).length>=8){var d="",c=[];for(var t in i){var s=i[t];1==f[s].length?(d+=f[s],c.push(t)):d+=n.BLANK_CHAR}var p=c.length;if(p>r){c=n._shuffle(c);for(var t=0;t<p-r;++t){var _=parseInt(c[t]);d=d.substr(0,_)+n.BLANK_CHAR+d.substr(_+1)}}if(n.solve(d))return d}}return n.generate(r)},n.solve=function(r,a){var e=n.validate_board(r);if(!0!==e)throw e;var i=0;for(var t in r)r[t]!==n.BLANK_CHAR&&n._in(r[t],n.DIGITS)&&++i;if(i<17)throw"Too few givens. Minimum givens is 17";a=a||!1;var f=n._get_candidates_map(r),u=n._search(f,a);if(u){var v="";for(var o in u)v+=u[o];return v}return!1},n.get_candidates=function(r){var a=n.validate_board(r);if(!0!==a)throw a;var e=n._get_candidates_map(r);if(!e)return!1;var i=[],t=[],f=0;for(var u in e){var v=e[u];t.push(v),f%9==8&&(i.push(t),t=[]),++f}return i},n._get_candidates_map=function(r){var a=n.validate_board(r);if(!0!==a)throw a;var e={},t=n._get_square_vals_map(r);for(var f in i)e[i[f]]=n.DIGITS;for(var u in t){var v=t[u];if(n._in(v,n.DIGITS)&&!n._assign(e,u,v))return!1}return e},n._search=function(r,a){if(!r)return!1;a=a||!1;var e=0,t=null;for(var f in i){var u=i[f],v=r[u].length;v>e&&(e=v,t=u)}if(1===e)return r;var o=10,s=null;for(f in i){var u=i[f],v=r[u].length;v<o&&v>1&&(o=v,s=u)}var l=r[s];if(a)for(var g=l.length-1;g>=0;--g){var h=l[g],d=JSON.parse(JSON.stringify(r)),c=n._search(n._assign(d,s,h),a);if(c)return c}else for(var g in l){var h=l[g],d=JSON.parse(JSON.stringify(r)),c=n._search(n._assign(d,s,h));if(c)return c}return!1},n._assign=function(r,a,e){var i=r[a].replace(e,"");for(var t in i){var f=i[t];if(!n._eliminate(r,a,f))return!1}return r},n._eliminate=function(r,a,e){if(!n._in(e,r[a]))return r;r[a]=r[a].replace(e,"");var i=r[a].length;if(1===i){var t=r[a];for(var v in u[a]){var o=u[a][v],s=n._eliminate(r,o,t);if(!s)return!1}}if(0===i)return!1;for(var l in f[a]){var g=f[a][l],h=[];for(var d in g){var c=g[d];n._in(e,r[c])&&h.push(c)}if(0===h.length)return!1;if(1===h.length){var s=n._assign(r,h[0],e);if(!s)return!1}}return r},n._get_square_vals_map=function(r){var n={};if(r.length!=i.length)throw"Board/squares length mismatch.";for(var a in i)n[i[a]]=r[a];return n},n._get_square_units_map=function(r,n){var a={};for(var e in r){var i=r[e],t=[];for(var f in n){var u=n[f];-1!==u.indexOf(i)&&t.push(u)}a[i]=t}return a},n._get_square_peers_map=function(r,n){var a={};for(var e in r){var i=r[e],t=n[i],f=[];for(var u in t){var v=t[u];for(var o in v){var s=v[o];-1===f.indexOf(s)&&s!==i&&f.push(s)}}a[i]=f}return a},n._get_all_units=function(r,a){var e=[];for(var i in r)e.push(n._cross(r[i],a));for(var t in a)e.push(n._cross(r,a[t]));var f=["ABC","DEF","GHI"],u=["123","456","789"];for(var v in f)for(var o in u)e.push(n._cross(f[v],u[o]));return e},n.board_string_to_grid=function(r){var n=[],a=[];for(var e in r)a.push(r[e]),e%9==8&&(n.push(a),a=[]);return n},n.board_grid_to_string=function(r){for(var n="",a=0;a<9;++a)for(var e=0;e<9;++e)n+=r[a][e];return n},n.print_board=function(r){var a=n.validate_board(r);if(!0!==a)throw a;var e="";for(var i in r)e+=r[i]+" ",i%3==2&&(e+="  "),i%9==8&&(e+="\n"),i%27==26&&(e+="\n");console.log(e)},n.validate_board=function(r){if(!r)return"Empty board";if(81!==r.length)return"Invalid board size. Board must be exactly 81 squares.";for(var a in r)if(!n._in(r[a],n.DIGITS)&&r[a]!==n.BLANK_CHAR)return"Invalid board character encountered at index "+a+": "+r[a];return!0},n._cross=function(r,n){var a=[];for(var e in r)for(var i in n)a.push(r[e]+n[i]);return a},n._in=function(r,n){return -1!==n.indexOf(r)},n._first_true=function(r){for(var n in r)if(r[n])return r[n];return!1},n._shuffle=function(r){for(var a=[],e=0;e<r.length;++e)a.push(!1);for(var e in r){for(var i=n._rand_range(r.length);a[i];)i=i+1>r.length-1?0:i+1;a[i]=r[e]}return a},n._rand_range=function(r,n){if(n=n||0,r)return Math.floor(Math.random()*(r-n))+n;throw"Range undefined"},n._strip_dups=function(r){var n=[],a={};for(var e in r){var i=r[e];a[i]||(n.push(i),a[i]=!0)}return n},n._force_range=function(r,n,a){return(r=r||0)<(a=a||0)?a:r>n?n:r},i=n._cross(a,e),t=n._get_all_units(a,e),f=n._get_square_units_map(i,t),u=n._get_square_peers_map(i,f)}(this);